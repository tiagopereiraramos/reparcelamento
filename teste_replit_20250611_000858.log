2025-06-11 00:08:58,267 - TesteReplitDetalhado - INFO - 🚀 INICIANDO TESTE REPLIT DETALHADO
2025-06-11 00:08:58,268 - TesteReplitDetalhado - INFO - ================================================================================
2025-06-11 00:08:58,268 - TesteReplitDetalhado - INFO - 📅 Data/Hora: 11/06/2025 00:08:58
2025-06-11 00:08:58,268 - TesteReplitDetalhado - INFO - 📁 Fonte dados: saldo_devedor_presente-20250610-093716.xlsx
2025-06-11 00:08:58,268 - TesteReplitDetalhado - INFO - ================================================================================
2025-06-11 00:09:58,349 - TesteReplitDetalhado - WARNING - ⚠️ Erro ao registrar teste no MongoDB: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6848c91aabc37d79267715e3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-06-11 00:09:58,349 - TesteReplitDetalhado - INFO - 📊 CARREGANDO ARQUIVO EXCEL REAL
2025-06-11 00:09:58,349 - TesteReplitDetalhado - INFO -    📁 Arquivo: /home/runner/workspace/saldo_devedor_presente-20250610-093716.xlsx
2025-06-11 00:09:58,458 - TesteReplitDetalhado - INFO - ✅ REGRA CARREGAMENTO: ARQUIVO_EXCEL_VALIDO
2025-06-11 00:09:58,458 - TesteReplitDetalhado - INFO -    📋 Critério: Arquivo deve existir e ser legível
2025-06-11 00:09:58,458 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: /home/runner/workspace/saldo_devedor_presente-20250610-093716.xlsx
2025-06-11 00:09:58,458 - TesteReplitDetalhado - INFO -    🎯 Resultado: Carregado com sucesso - 26 registros
2025-06-11 00:09:58,459 - TesteReplitDetalhado - DEBUG -    🔍 total_registros: 26
2025-06-11 00:09:58,459 - TesteReplitDetalhado - DEBUG -    🔍 colunas: ['Título', 'Parcela/Sequencial', 'Parcela/Condição', 'Cód. empresa', 'Empresa', 'Cód. centro de custo', 'Centro de custo', 'Documento', 'Nº documento', 'Cód. cliente', 'Cliente', 'Status da parcela', 'Tipo condição', 'Data vencimento', 'Valor original', 'Indexador', 'Correção monetária', 'Juros contratuais', 'Valor atualizado', 'Taxa administrativa', 'Seguro', 'Valor corrigido', 'Data base de juros', 'Juros %', 'Tipo de juros', 'Data base correção', 'Data correção', 'Dias para desconto VP', 'Juros VP %', 'Valor presente', 'Valor desconto comercial', 'Dias de atraso', 'Multa %', 'Juros de mora', 'Valor de acréscimo', 'Valor a receber', 'Data da baixa', 'Valor da baixa', 'Recebimento líquido']
2025-06-11 00:09:58,459 - TesteReplitDetalhado - DEBUG -    🔍 tamanho_arquivo: 10224
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO - 🔍 ANÁLISE DETALHADA DOS DADOS EXCEL
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO - ============================================================
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO - ✅ REGRA VALIDACAO_ESTRUTURA: COLUNAS_OBRIGATORIAS
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO -    📋 Critério: Arquivo deve conter colunas essenciais para processamento
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: ['Parcela/Sequencial', 'Cód. centro de custo', 'Valor original', 'Documento', 'Status da parcela']
2025-06-11 00:09:58,459 - TesteReplitDetalhado - INFO -    🎯 Resultado: Encontradas 5/5 colunas
2025-06-11 00:09:58,459 - TesteReplitDetalhado - DEBUG -    🔍 colunas_presentes: ['Parcela/Sequencial', 'Cód. centro de custo', 'Valor original', 'Documento', 'Status da parcela']
2025-06-11 00:09:58,460 - TesteReplitDetalhado - DEBUG -    🔍 colunas_ausentes: []
2025-06-11 00:09:58,460 - TesteReplitDetalhado - DEBUG -    🔍 todas_colunas_arquivo: ['Título', 'Parcela/Sequencial', 'Parcela/Condição', 'Cód. empresa', 'Empresa', 'Cód. centro de custo', 'Centro de custo', 'Documento', 'Nº documento', 'Cód. cliente', 'Cliente', 'Status da parcela', 'Tipo condição', 'Data vencimento', 'Valor original', 'Indexador', 'Correção monetária', 'Juros contratuais', 'Valor atualizado', 'Taxa administrativa', 'Seguro', 'Valor corrigido', 'Data base de juros', 'Juros %', 'Tipo de juros', 'Data base correção', 'Data correção', 'Dias para desconto VP', 'Juros VP %', 'Valor presente', 'Valor desconto comercial', 'Dias de atraso', 'Multa %', 'Juros de mora', 'Valor de acréscimo', 'Valor a receber', 'Data da baixa', 'Valor da baixa', 'Recebimento líquido']
2025-06-11 00:09:58,462 - TesteReplitDetalhado - INFO - ✅ REGRA VALIDACAO_ELEGIBILIDADE: LIMITE_INADIMPLENCIA_PDD
2025-06-11 00:09:58,462 - TesteReplitDetalhado - INFO -    📋 Critério: Cliente com 3 ou mais parcelas CT vencidas = INADIMPLENTE
2025-06-11 00:09:58,462 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: 0
2025-06-11 00:09:58,462 - TesteReplitDetalhado - INFO -    🎯 Resultado: PODE reparcelar
2025-06-11 00:09:58,462 - TesteReplitDetalhado - DEBUG -    🔍 qtd_ct_vencidas: 0
2025-06-11 00:09:58,462 - TesteReplitDetalhado - DEBUG -    🔍 limite_pdd: 3
2025-06-11 00:09:58,462 - TesteReplitDetalhado - DEBUG -    🔍 status_cliente: ADIMPLENTE
2025-06-11 00:09:58,462 - TesteReplitDetalhado - DEBUG -    🔍 parcelas_ct_detalhes: []
2025-06-11 00:09:58,462 - TesteReplitDetalhado - INFO - ❌ REGRA CALCULO_FINANCEIRO: SALDO_TOTAL
2025-06-11 00:09:58,463 - TesteReplitDetalhado - INFO -    📋 Critério: Soma de todos os valores pendentes
2025-06-11 00:09:58,463 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: 0.0
2025-06-11 00:09:58,463 - TesteReplitDetalhado - INFO -    🎯 Resultado: R$ 0.00
2025-06-11 00:09:58,464 - TesteReplitDetalhado - DEBUG -    🔍 saldo_formatado: R$ 0.00
2025-06-11 00:09:58,464 - TesteReplitDetalhado - DEBUG -    🔍 total_parcelas: 26
2025-06-11 00:09:58,464 - TesteReplitDetalhado - DEBUG -    🔍 valor_medio_parcela: 0.0
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO - 💰 CÁLCULO DETALHADO DO REPARCELAMENTO
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO - ============================================================
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO - ✅ REGRA CALCULO_REPARCELAMENTO: INDICE_ECONOMICO_PDD
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO -    📋 Critério: SEMPRE usar IGP-M conforme especificação PDD
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: IGP-M: 3.89%
2025-06-11 00:09:58,464 - TesteReplitDetalhado - INFO -    🎯 Resultado: Índice IGP-M 3.89% será aplicado
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 indice_escolhido: IGP-M
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 valor_percentual: 3.89
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 periodo_referencia: Dezembro/2024
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 ipca_disponivel: 4.62
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 motivo_escolha: Obrigatório conforme PDD
2025-06-11 00:09:58,465 - TesteReplitDetalhado - INFO - ❌ REGRA CALCULO_REPARCELAMENTO: CALCULO_NOVO_SALDO
2025-06-11 00:09:58,465 - TesteReplitDetalhado - INFO -    📋 Critério: Saldo atual × (1 + IGP-M/100)
2025-06-11 00:09:58,465 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: R$ 0.00 × 1.0389
2025-06-11 00:09:58,465 - TesteReplitDetalhado - INFO -    🎯 Resultado: R$ 0.00
2025-06-11 00:09:58,465 - TesteReplitDetalhado - DEBUG -    🔍 saldo_anterior: 0.0
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 fator_correcao: 1.0389
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 novo_saldo: 0.0
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 diferenca_valor: 0.0
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 percentual_aumento: 0
2025-06-11 00:09:58,466 - TesteReplitDetalhado - INFO - ✅ REGRA CONFIGURACAO_PDD: PARAMETRO_TIPO_CONDICAO
2025-06-11 00:09:58,466 - TesteReplitDetalhado - INFO -    📋 Critério: Valor tipo_condicao deve ser fixo conforme PDD
2025-06-11 00:09:58,466 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: PM
2025-06-11 00:09:58,466 - TesteReplitDetalhado - INFO -    🎯 Resultado: Configurado: PM
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 parametro: tipo_condicao
2025-06-11 00:09:58,466 - TesteReplitDetalhado - DEBUG -    🔍 valor_configurado: PM
2025-06-11 00:09:58,466 - TesteReplitDetalhado - INFO - ✅ REGRA CONFIGURACAO_PDD: PARAMETRO_INDEXADOR
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    📋 Critério: Valor indexador deve ser fixo conforme PDD
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: IGP-M
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    🎯 Resultado: Configurado: IGP-M
2025-06-11 00:09:58,467 - TesteReplitDetalhado - DEBUG -    🔍 parametro: indexador
2025-06-11 00:09:58,467 - TesteReplitDetalhado - DEBUG -    🔍 valor_configurado: IGP-M
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO - ✅ REGRA CONFIGURACAO_PDD: PARAMETRO_TIPO_JUROS
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    📋 Critério: Valor tipo_juros deve ser fixo conforme PDD
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: Fixo
2025-06-11 00:09:58,467 - TesteReplitDetalhado - INFO -    🎯 Resultado: Configurado: Fixo
2025-06-11 00:09:58,467 - TesteReplitDetalhado - DEBUG -    🔍 parametro: tipo_juros
2025-06-11 00:09:58,467 - TesteReplitDetalhado - DEBUG -    🔍 valor_configurado: Fixo
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO - ✅ REGRA CONFIGURACAO_PDD: PARAMETRO_PERCENTUAL_JUROS
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    📋 Critério: Valor percentual_juros deve ser fixo conforme PDD
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: 8.0
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    🎯 Resultado: Configurado: 8.0
2025-06-11 00:09:58,468 - TesteReplitDetalhado - DEBUG -    🔍 parametro: percentual_juros
2025-06-11 00:09:58,468 - TesteReplitDetalhado - DEBUG -    🔍 valor_configurado: 8.0
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO - ✅ REGRA CONFIGURACAO_PDD: DATA_PRIMEIRO_VENCIMENTO
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    📋 Critério: Próximo mês, dia 15
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: 15/07/2025
2025-06-11 00:09:58,468 - TesteReplitDetalhado - INFO -    🎯 Resultado: 1º vencimento: 15/07/2025
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 data_calculada: 2025-07-15
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 data_referencia: 2025-06-11
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 regra_aplicada: Próximo mês dia 15
2025-06-11 00:09:58,469 - TesteReplitDetalhado - INFO - ✅ REGRA CALCULO_REPARCELAMENTO: QUANTIDADE_PARCELAS
2025-06-11 00:09:58,469 - TesteReplitDetalhado - INFO -    📋 Critério: Manter número de parcelas pendentes
2025-06-11 00:09:58,469 - TesteReplitDetalhado - INFO -    📊 Valor avaliado: 26
2025-06-11 00:09:58,469 - TesteReplitDetalhado - INFO -    🎯 Resultado: 26 parcelas × R$ 0.00
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 quantidade_parcelas: 26
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 valor_parcela_estimado: 0.0
2025-06-11 00:09:58,469 - TesteReplitDetalhado - DEBUG -    🔍 valor_total: 0.0
2025-06-11 00:10:28,889 - TesteReplitDetalhado - WARNING - ⚠️ Erro ao atualizar resultado no MongoDB: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6848c91aabc37d79267715e3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-06-11 00:10:28,889 - TesteReplitDetalhado - INFO - 
📊 RESUMO FINAL DO TESTE
2025-06-11 00:10:28,889 - TesteReplitDetalhado - INFO - ============================================================
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - 📋 Contrato: TESTE_REPLIT_001
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - 👤 Cliente: CLIENTE TESTE EXCEL REAL
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - 🎯 Status: ADIMPLENTE
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - ✅ Pode reparcelar: SIM
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - 📈 Regras processadas: 12
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - ✅ Regras aprovadas: 10
2025-06-11 00:10:28,890 - TesteReplitDetalhado - INFO - ❌ Regras reprovadas: 2
2025-06-11 00:10:28,891 - TesteReplitDetalhado - INFO - 💰 Novo saldo: R$ 0.00
2025-06-11 00:10:28,891 - TesteReplitDetalhado - INFO - 📊 Parcelas: 26
2025-06-11 00:10:28,891 - TesteReplitDetalhado - INFO - 📅 1º vencimento: 15/07/2025
2025-06-11 00:10:28,891 - TesteReplitDetalhado - INFO - 📈 Índice aplicado: IGP-M 3.89%
2025-06-11 00:10:28,891 - TesteReplitDetalhado - INFO - ============================================================
2025-06-11 00:10:28,894 - TesteReplitDetalhado - INFO - 📄 Relatório salvo em: relatorio_teste_replit_20250611_001028.json
